{"version":3,"file":"component---src-pages-logs-10-06-2023-inspecting-docker-images-mdx-29f6e510324b0ed8e19a.js","mappings":"iRAQaA,EAAe,GACtBC,EAAc,CAClBD,aAAAA,GAEIE,EAAYC,EAAAA,EACH,SAASC,EAAT,GAGX,IAFFC,EAEC,EAFDA,WACGC,GACF,YACD,OAAO,QAACJ,EAAD,iBAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,eAG5E,8CACA,gQACI,sBAAYC,WAAW,KAAvB,mBADJ,+PAEA,oCAAsB,aAAGA,WAAW,IAChC,KAAQ,qCADU,QAAtB,MAGA,gEACA,iCACE,SAAY,QACZ,SAAY,UAFd,gBAIQ,gBAAMA,WAAW,wBACrB,KAAQ,QADJ,mBAJR,eAQA,iCACE,SAAY,QACZ,SAAY,UAFd,gBAIQ,gBAAMA,WAAW,wBACrB,KAAQ,QADJ,iBAJR,eAQA,0GACA,kBAAG,gBAAMA,WAAW,IAChB,UAAa,4BACb,MAAS,CACP,SAAY,WACZ,QAAW,QACX,WAAc,OACd,YAAe,OACf,SAAY,WAPf,YAUC,aAAGA,WAAW,OACZ,UAAa,yBACb,KAAQ,qEACR,MAAS,CACP,QAAW,SAEb,OAAU,SACV,IAAO,YAPT,UASF,gBAAMA,WAAW,IACX,UAAa,qCACb,MAAS,CACP,cAAiB,sBACjB,SAAY,WACZ,OAAU,IACV,KAAQ,IACR,gBAAmB,wwBACnB,eAAkB,QAClB,QAAW,WAlBjB,QAqBJ,eAAKA,WAAW,IACR,UAAa,0BACb,IAAO,qBACP,MAAS,qBACT,IAAO,qEACP,OAAU,CAAC,0EAA2E,0EAA2E,2EAA4E,2EAA4E,4EACzT,MAAS,oCACT,MAAS,CACP,MAAS,OACT,OAAU,OACV,OAAU,IACV,cAAiB,SACjB,SAAY,WACZ,IAAO,IACP,KAAQ,KAEV,QAAW,OACX,SAAY,UAtChB,QAVD,YAoDH,yCAA2B,sBAAYA,WAAW,KAAvB,iBAA3B,8IACA,+DAAiD,sBAAYA,WAAW,KAAvB,gBAAjD,8FAKJJ,EAAWK,gBAAiB,G,sBCtGb,SAASC,EAA8BC,EAAQC,GAC5D,GAAc,MAAVD,EAAgB,MAAO,GAC3B,IAEIE,EAAKC,EAFLC,EAAS,GACTC,EAAaC,OAAOC,KAAKP,GAG7B,IAAKG,EAAI,EAAGA,EAAIE,EAAWG,OAAQL,IACjCD,EAAMG,EAAWF,GACbF,EAASQ,QAAQP,IAAQ,IAC7BE,EAAOF,GAAOF,EAAOE,IAGvB,OAAOE,E","sources":["webpack://denntenna.github.io/./src/pages/logs/10-06-2023-inspecting-docker-images.mdx","webpack://denntenna.github.io/./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/denntenna.github.io/denntenna.github.io/src/components/default-mdx-layout.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2>{`Profiling Docker Images`}</h2>\n    <p>{`As it happens in the middle of a frantic week of prototyping a nodejs app, I installed a bunch of dependencies and was ready to deploy my app to the cloud. At which point I noticed that the docker build step was taking forever.\nI ran `}<inlineCode parentName=\"p\">{`docker image ls`}</inlineCode>{` and saw that my image was 4 GBs in size. Although I wanted to blame it on the random libraries I had installed, the huge size made me think it was a mistake in my .gitignore file and maybe I was adding some images or something into my docker images.`}</p>\n    <p>{`I was saved by `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/wagoodman/dive\"\n      }}>{`dive`}</a>{`.`}</p>\n    <p>{`Find the ID of the offending docker image.`}</p>\n    <deckgo-highlight-code {...{\n      \"language\": \"shell\",\n      \"terminal\": \"carbon\"\n    }}>{`\n          `}<code parentName=\"deckgo-highlight-code\" {...{\n        \"slot\": \"code\"\n      }}>{`docker image ls`}</code>{`\n        `}</deckgo-highlight-code>\n    <deckgo-highlight-code {...{\n      \"language\": \"shell\",\n      \"terminal\": \"carbon\"\n    }}>{`\n          `}<code parentName=\"deckgo-highlight-code\" {...{\n        \"slot\": \"code\"\n      }}>{`dive IMAGE_ID`}</code>{`\n        `}</deckgo-highlight-code>\n    <p>{`This brings up a tree view of all the files within the various layers of your image.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1200px\"\n        }\n      }}>{`\n      `}<a parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-link\",\n          \"href\": \"/static/177a87f2d7ae0fcc67c0d41424c92dab/29114/dive-screenshot.png\",\n          \"style\": {\n            \"display\": \"block\"\n          },\n          \"target\": \"_blank\",\n          \"rel\": \"noopener\"\n        }}>{`\n    `}<span parentName=\"a\" {...{\n            \"className\": \"gatsby-resp-image-background-image\",\n            \"style\": {\n              \"paddingBottom\": \"56.333333333333336%\",\n              \"position\": \"relative\",\n              \"bottom\": \"0\",\n              \"left\": \"0\",\n              \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4ElEQVQoz12PW4+aUBRGSTM6KireAMELcDggAp4bB1BuTr1mps3YhybtUx/7/39CozPtdCZZ+bKTb6/sbGHP0NksdvO4HJNKo4WCs9Eqk9F1kMNnUl7w5wvdfufHr6iIux6qm7gBUM3gg1D4sf/y+/HXz+xSTXmukmQQxD0/7vu85/P+spijakYrG+/cZOuhSPJo26Edh7TsVCXCEZY7M60mUamzSo9e4NKStG5LfROJFhmYibyINIOINmlB0oK4ARIZCweYlxrlkkdFh7Zd9j9dh41sJsFIBmvV5xNAJfBOPjrF2SkepnHS93nXe+muNCFtw0iGrAu5AtdqsJl5tH2rxL8y63rbCf+GT3sz/SCzjptpK95bZHpYTkimh1R03l1mkldq9Hm1z1X8ZrYgbtpc8nZGmvSDUmcHkFHRwU37o7wZrZ6WD5mCWdu5fn4Dt2DcW+6MNB2GlR4drE3UWfxrSdNOFSKE91ZYN1EDhHXTv5sHNSOoGWHdDO9NIsJ8TFjXzVRUaPRa3b3if5rRni8cQX6ysvMtTyA/gexs53tjnQ9JpUZnkJcyy4d0q/FHp3wDFk/BQcCIu2ABZsCagdecA0M3FEnV5rq1sMa6pkxUfaojd4lDgnyMfERXdOWhP/XMZp1uxZQcAAAAAElFTkSuQmCC')\",\n              \"backgroundSize\": \"cover\",\n              \"display\": \"block\"\n            }\n          }}></span>{`\n  `}<img parentName=\"a\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"alt\": \"Screenshot of Dive\",\n            \"title\": \"Screenshot of Dive\",\n            \"src\": \"/static/177a87f2d7ae0fcc67c0d41424c92dab/c1b63/dive-screenshot.png\",\n            \"srcSet\": [\"/static/177a87f2d7ae0fcc67c0d41424c92dab/5a46d/dive-screenshot.png 300w\", \"/static/177a87f2d7ae0fcc67c0d41424c92dab/0a47e/dive-screenshot.png 600w\", \"/static/177a87f2d7ae0fcc67c0d41424c92dab/c1b63/dive-screenshot.png 1200w\", \"/static/177a87f2d7ae0fcc67c0d41424c92dab/d61c2/dive-screenshot.png 1800w\", \"/static/177a87f2d7ae0fcc67c0d41424c92dab/29114/dive-screenshot.png 1920w\"],\n            \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            },\n            \"loading\": \"lazy\",\n            \"decoding\": \"async\"\n          }}></img>{`\n  `}</a>{`\n    `}</span></p>\n    <p>{`Thankfully it was a `}<inlineCode parentName=\"p\">{`.parcel-cache`}</inlineCode>{` that snuck into the image. Adding it to .dockerignore brought down the image size from 4 GB to 814 MB. This big drop made me write this.`}</p>\n    <p>{`Cherry on top : I realized that there's a `}<inlineCode parentName=\"p\">{`--production`}</inlineCode>{` flag for npm install that removes devDependencies. This brought the size down to 358 MB.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent","_objectWithoutPropertiesLoose","source","excluded","key","i","target","sourceKeys","Object","keys","length","indexOf"],"sourceRoot":""}